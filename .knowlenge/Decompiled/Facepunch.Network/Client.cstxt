using System;
using Facepunch;
using Network;
using Network.Visibility;

public class Client : BaseNetwork
{
	public static float MaxReceiveTime = 10f;

	public static float MinReceiveFraction = 0.05f;

	public Manager visibility;

	public static string disconnectReason;

	public Stats IncomingStats = new Stats();

	public IClientCallback callbackHandler;

	public Connection Connection { get; protected set; }

	public virtual bool IsPlaying { get; }

	public string ConnectedAddress { get; set; } = "unset";

	public int ConnectedPort { get; set; }

	public string ServerName { get; set; }

	public bool IsOfficialServer { get; set; }

	public bool IsRecording
	{
		get
		{
			if (Connection == null)
			{
				return false;
			}
			return Connection.IsRecording;
		}
	}

	public string RecordFilename => Connection.RecordFilename;

	public TimeSpan RecordTimeElapsed => Connection.RecordTimeElapsed;

	public virtual bool Connect(string strURL, int port)
	{
		disconnectReason = "Disconnected";
		return true;
	}

	public virtual void Cycle()
	{
	}

	public virtual void Disconnect(string reason, bool sendReasonToServer = true)
	{
	}

	public virtual bool IsConnected()
	{
		return false;
	}

	protected void OnDisconnected(string str)
	{
		if (callbackHandler != null)
		{
			callbackHandler.OnClientDisconnected(str);
		}
	}

	public Networkable CreateNetworkable(uint networkID, uint networkGroup)
	{
		Networkable networkable = Pool.Get<Networkable>();
		networkable.ID = networkID;
		networkable.SwitchGroup(visibility.Get(networkGroup));
		return networkable;
	}

	public void DestroyNetworkable(ref Networkable networkable)
	{
		networkable.Destroy();
		Pool.Free(ref networkable);
	}

	public void SetupNetworkable(Networkable net)
	{
		net.cl = this;
	}

	public virtual int GetLastPing()
	{
		return 0;
	}

	public bool StartRecording(string targetFilename, IDemoHeader header)
	{
		return Connection.StartRecording(targetFilename, header);
	}

	public void StopRecording()
	{
		Connection.StopRecording();
	}
}
