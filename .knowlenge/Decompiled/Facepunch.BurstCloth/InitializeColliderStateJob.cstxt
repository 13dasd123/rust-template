using Facepunch.BurstCloth;
using Facepunch.BurstCloth.Jobs;
using Unity.Collections;
using Unity.Mathematics;
using UnityEngine.Jobs;

internal struct InitializeColliderStateJob : IJobParallelForTransform
{
	[ReadOnly]
	[NativeMatchesParallelForLength]
	public NativeArray<ColliderData> Data;

	[WriteOnly]
	[NativeMatchesParallelForLength]
	public NativeArray<ColliderState> State;

	public void Execute(int index, [ReadOnly] TransformAccess transform)
	{
		ref readonly ColliderData @readonly = ref Data.GetReadonly(index);
		ref ColliderState reference = ref State.Get(index);
		float3 @float = transform.position;
		quaternion q = transform.rotation;
		reference.PositionA = @float + math.mul(q, @readonly.LocalPositionA);
		reference.PositionB = @float + math.mul(q, @readonly.LocalPositionB);
	}
}
