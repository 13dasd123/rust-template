using Rust.Ai;
using UnityEngine;

public class HasAllyInLineOfFire : BaseScorer
{
	public override float GetScore(BaseContext ctx)
	{
		if (ctx is NPCHumanContext nPCHumanContext)
		{
			Scientist scientist = nPCHumanContext.Human as Scientist;
			if (scientist != null && scientist.GetAlliesInRange(out var allies) > 0)
			{
				foreach (Scientist item in allies)
				{
					Vector3 vector = nPCHumanContext.EnemyPosition - nPCHumanContext.Position;
					Vector3 vector2 = item.Entity.ServerPosition - nPCHumanContext.Position;
					if (vector2.sqrMagnitude < vector.sqrMagnitude && Vector3.Dot(vector.normalized, vector2.normalized) > 0.9f)
					{
						return 1f;
					}
				}
			}
		}
		return 0f;
	}
}
