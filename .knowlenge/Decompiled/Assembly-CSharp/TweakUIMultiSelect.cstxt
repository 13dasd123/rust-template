using System.Linq;
using UnityEngine;
using UnityEngine.UI;

public class TweakUIMultiSelect : MonoBehaviour
{
	public ToggleGroup toggleGroup;

	public string convarName = "effects.motionblur";

	internal ConsoleSystem.Command conVar;

	protected void Awake()
	{
		conVar = ConsoleSystem.Index.Client.Find(convarName);
		if (conVar != null)
		{
			UpdateToggleGroup();
		}
		else
		{
			Debug.LogWarning("Tweak Slider Convar Missing: " + convarName);
		}
	}

	protected void OnEnable()
	{
		UpdateToggleGroup();
	}

	public void OnChanged()
	{
		UpdateConVar();
	}

	private void UpdateToggleGroup()
	{
		if (conVar != null)
		{
			string @string = conVar.String;
			Toggle[] componentsInChildren = toggleGroup.GetComponentsInChildren<Toggle>();
			foreach (Toggle toggle in componentsInChildren)
			{
				toggle.isOn = toggle.name == @string;
			}
		}
	}

	private void UpdateConVar()
	{
		if (conVar != null)
		{
			Toggle toggle = (from x in toggleGroup.GetComponentsInChildren<Toggle>()
				where x.isOn
				select x).FirstOrDefault();
			if (!(toggle == null) && !(conVar.String == toggle.name))
			{
				conVar.Set(toggle.name);
			}
		}
	}
}
