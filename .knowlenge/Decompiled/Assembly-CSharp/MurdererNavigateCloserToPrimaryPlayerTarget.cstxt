using System;
using UnityEngine;

public class MurdererNavigateCloserToPrimaryPlayerTarget : MurdererBaseNavigateTo
{
	public static Vector3 GetDestination(MurdererContext context)
	{
		NpcPlayerInfo primaryEnemyPlayerTarget = context.GetPrimaryEnemyPlayerTarget();
		if (primaryEnemyPlayerTarget.Player != null)
		{
			return primaryEnemyPlayerTarget.Player.transform.position;
		}
		return context.Body.transform.position;
	}

	protected override Vector3 _GetDestination(MurdererContext context)
	{
		return GetDestination(context);
	}

	public override void Execute(MurdererContext context)
	{
		OnPreStart(context);
		context.ReserveCoverPoint(null);
		context.Domain.SetDestination(_GetDestination(context), passPathValidity: true);
		if (!RunUntilArrival)
		{
			context.OnWorldStateChangedEvent = (MurdererContext.WorldStateChangedEvent)Delegate.Combine(context.OnWorldStateChangedEvent, new MurdererContext.WorldStateChangedEvent(base.TrackWorldState));
		}
		OnStart(context);
	}
}
