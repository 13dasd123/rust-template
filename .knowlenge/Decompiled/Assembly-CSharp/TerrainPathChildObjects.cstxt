using System.Collections.Generic;
using UnityEngine;

public class TerrainPathChildObjects : MonoBehaviour
{
	public bool Spline = true;

	public float Width = 12f;

	public float Offset = -1.5f;

	public float Padding = 5f;

	public float Fade = 10f;

	[InspectorFlags]
	public TerrainSplat.Enum Splat = TerrainSplat.Enum.Dirt;

	[InspectorFlags]
	public TerrainTopology.Enum Topology = TerrainTopology.Enum.Road;

	public InfrastructureType Type;

	protected void Awake()
	{
		List<Vector3> list = new List<Vector3>();
		foreach (Transform item in base.transform)
		{
			list.Add(item.position);
		}
		if (list.Count >= 2)
		{
			switch (Type)
			{
			case InfrastructureType.Road:
				TerrainMeta.Path.Roads.Add(new PathList("Road " + TerrainMeta.Path.Roads.Count, list.ToArray(), Width, Offset, Padding, Fade, (int)Topology, (int)Splat, Spline));
				break;
			case InfrastructureType.Power:
				TerrainMeta.Path.Powerlines.Add(new PathList("Powerline " + TerrainMeta.Path.Powerlines.Count, list.ToArray(), Width, Offset, Padding, Fade, (int)Topology, (int)Splat, Spline));
				break;
			}
		}
		GameManager.Destroy(base.gameObject);
	}

	protected void OnDrawGizmos()
	{
		bool flag = false;
		Vector3 a = Vector3.zero;
		foreach (Transform item in base.transform)
		{
			Vector3 position = item.position;
			if (flag)
			{
				Gizmos.color = new Color(0.5f, 0.5f, 0.5f, 1f);
				GizmosUtil.DrawWirePath(a, position, 0.5f * Width);
			}
			a = position;
			flag = true;
		}
	}
}
