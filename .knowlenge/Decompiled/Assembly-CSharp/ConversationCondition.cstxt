using System;

[Serializable]
public class ConversationCondition
{
	public enum ConditionType
	{
		None,
		HasHealth,
		HasScrap,
		ProviderBusy,
		MissionComplete,
		MissionAttempted,
		CanAccept
	}

	public ConditionType conditionType;

	public uint conditionAmount;

	public BaseMission conditionMission;

	public bool inverse;

	public string failedSpeechNode;

	public bool Passes(BasePlayer player, IConversationProvider provider)
	{
		bool flag = false;
		if (conditionType == ConditionType.HasScrap)
		{
			flag = player.inventory.GetAmount(ItemManager.FindItemDefinition("scrap").itemid) >= conditionAmount;
		}
		else if (conditionType == ConditionType.HasHealth)
		{
			flag = player.health >= (float)conditionAmount;
		}
		else if (conditionType == ConditionType.ProviderBusy)
		{
			flag = provider.ProviderBusy();
		}
		else if (conditionType == ConditionType.MissionComplete)
		{
			flag = player.HasCompletedMission(MissionID());
		}
		else if (conditionType == ConditionType.MissionAttempted)
		{
			flag = player.HasAttemptedMission(MissionID());
		}
		else if (conditionType == ConditionType.CanAccept)
		{
			flag = player.CanAcceptMission(MissionID());
		}
		if (!inverse)
		{
			return flag;
		}
		return !flag;
	}

	private uint MissionID()
	{
		if (!(conditionMission != null))
		{
			return conditionAmount;
		}
		return conditionMission.id;
	}
}
