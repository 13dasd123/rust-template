using UnityEngine;

public static class CollisionEx
{
	public static BaseEntity GetEntity(this Collision col)
	{
		if (col.transform.CompareTag("MeshColliderBatch"))
		{
			MeshColliderBatch component = col.gameObject.GetComponent<MeshColliderBatch>();
			if ((bool)component)
			{
				for (int i = 0; i < col.contacts.Length; i++)
				{
					ContactPoint contactPoint = col.contacts[i];
					Ray ray = new Ray(contactPoint.point + contactPoint.normal * 0.01f, -contactPoint.normal);
					if (col.collider.Raycast(ray, out var hitInfo, 1f))
					{
						return RaycastHitEx.GetEntity(hitInfo);
					}
				}
			}
		}
		return GameObjectEx.ToBaseEntity(col.gameObject);
	}
}
