using Apex.Serialization;
using Rust.Ai;

public class AttackOperator : BaseAction
{
	public enum AttackType
	{
		CloseRange,
		MediumRange,
		LongRange
	}

	public enum AttackTargetType
	{
		Enemy
	}

	[ApexSerialization]
	public AttackType Type;

	[ApexSerialization]
	public AttackTargetType Target;

	public override void DoExecute(BaseContext c)
	{
		if (Target == AttackTargetType.Enemy)
		{
			AttackEnemy(c, Type);
		}
	}

	public static void AttackEnemy(BaseContext c, AttackType type)
	{
		if (c.GetFact(BaseNpc.Facts.IsAttackReady) != 0)
		{
			BaseCombatEntity target = null;
			if (c.EnemyNpc != null)
			{
				target = c.EnemyNpc;
			}
			if (c.EnemyPlayer != null)
			{
				target = c.EnemyPlayer;
			}
			c.AIAgent.StartAttack(type, target);
			c.SetFact(BaseNpc.Facts.IsAttackReady, 0);
		}
	}
}
