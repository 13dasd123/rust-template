using System;
using Rust.Ai.Gen2;
using UnityEngine;

[Serializable]
[SoftRequireComponent(typeof(SenseComponent))]
public class State_Intimidated : State_PlayAnimationRM
{
	private static readonly float facingAwayDotThreshold = Mathf.Cos(MathF.PI / 2f);

	public override EFSMStateStatus OnStateEnter()
	{
		FaceTarget = true;
		if (Owner.GetTargetPosition(out var targetPos) && Vector3.Dot(Owner.transform.forward, (Owner.transform.position - targetPos).normalized) > facingAwayDotThreshold)
		{
			return EFSMStateStatus.Success;
		}
		return base.OnStateEnter();
	}
}
