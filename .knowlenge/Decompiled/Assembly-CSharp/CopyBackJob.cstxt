using Facepunch.NativeMeshSimplification;
using Unity.Burst;
using Unity.Collections;
using Unity.Jobs;
using Unity.Mathematics;

[BurstCompile]
internal struct CopyBackJob : IJob
{
	public NativeList<float3> VerticesIn;

	public NativeList<int> IndicesIn;

	public NativeList<NativeMeshSimplifier.Triangle> TrianglesOut;

	public NativeList<NativeMeshSimplifier.Vertex> VerticesOut;

	public void Execute()
	{
		VerticesIn.Clear();
		VerticesIn.SetCapacity(VerticesOut.Length);
		for (int i = 0; i < VerticesOut.Length; i++)
		{
			ref NativeList<float3> verticesIn = ref VerticesIn;
			NativeMeshSimplifier.Vertex vertex = VerticesOut[i];
			verticesIn.Add(in vertex.p);
		}
		IndicesIn.Clear();
		IndicesIn.SetCapacity(TrianglesOut.Length * 3);
		for (int j = 0; j < TrianglesOut.Length; j++)
		{
			IndicesIn.Add(TrianglesOut[j].vIndex[0]);
			IndicesIn.Add(TrianglesOut[j].vIndex[1]);
			IndicesIn.Add(TrianglesOut[j].vIndex[2]);
		}
	}
}
