using UnityEngine;

public class AStarNavigateToPreferredFightingRange : BaseNavigateTo
{
	public static Vector3 GetPreferredFightingPosition(ScientistAStarContext context)
	{
		if (Time.time - context.Memory.CachedPreferredDistanceDestinationTime < 0.01f)
		{
			return context.Memory.CachedPreferredDistanceDestination;
		}
		NpcPlayerInfo primaryEnemyPlayerTarget = context.GetPrimaryEnemyPlayerTarget();
		if (primaryEnemyPlayerTarget.Player != null)
		{
			AttackEntity firearm = context.Domain.GetFirearm();
			float num = context.Body.AiDefinition.Engagement.CenterOfMediumRangeFirearm(firearm);
			float num2 = num * num;
			Vector3 vector = ((!(primaryEnemyPlayerTarget.SqrDistance < num2)) ? (primaryEnemyPlayerTarget.Player.transform.position - context.BodyPosition).normalized : (context.BodyPosition - primaryEnemyPlayerTarget.Player.transform.position).normalized);
			return context.BodyPosition + vector * num;
		}
		return context.BodyPosition;
	}

	protected override Vector3 _GetDestination(ScientistAStarContext context)
	{
		return GetPreferredFightingPosition(context);
	}
}
