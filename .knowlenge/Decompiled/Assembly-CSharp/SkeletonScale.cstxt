using UnityEngine;

public class SkeletonScale : MonoBehaviour
{
	protected BoneInfoComponent[] bones;

	public int seed;

	public GameObject leftShoulder;

	public GameObject rightShoulder;

	public GameObject spine;

	protected void Awake()
	{
		bones = GetComponentsInChildren<BoneInfoComponent>(includeInactive: true);
	}

	public void UpdateBones(int seedNumber)
	{
		seed = seedNumber;
		BoneInfoComponent[] array = bones;
		foreach (BoneInfoComponent boneInfoComponent in array)
		{
			if (!(boneInfoComponent.sizeVariation == Vector3.zero))
			{
				Random.State state = Random.state;
				Random.InitState(boneInfoComponent.sizeVariationSeed + seed);
				boneInfoComponent.transform.localScale = Vector3.one + boneInfoComponent.sizeVariation * Random.Range(-1f, 1f);
				Random.state = state;
			}
		}
		if (spine != null)
		{
			Transform obj = rightShoulder.transform;
			Vector3 localScale = (leftShoulder.transform.localScale = new Vector3(1f / spine.transform.localScale.x, 1f / spine.transform.localScale.y, 1f / spine.transform.localScale.z));
			obj.localScale = localScale;
		}
	}

	public void Reset()
	{
		BoneInfoComponent[] array = bones;
		foreach (BoneInfoComponent boneInfoComponent in array)
		{
			if (!(boneInfoComponent.sizeVariation == Vector3.zero))
			{
				boneInfoComponent.transform.localScale = Vector3.one;
			}
		}
	}
}
