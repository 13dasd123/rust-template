using System;
using System.Reflection;

internal static class MemberInfoExt
{
	internal static void SetMemberValue(this MemberInfo info, object instance, object value)
	{
		switch (info.MemberType)
		{
		case MemberTypes.Field:
			((FieldInfo)info).SetValue(instance, value);
			break;
		case MemberTypes.Property:
		{
			PropertyInfo propertyInfo = (PropertyInfo)info;
			if (propertyInfo.CanWrite)
			{
				((PropertyInfo)info).SetValue(instance, value);
				break;
			}
			throw new Exception(propertyInfo.DeclaringType?.Name + "." + propertyInfo.Name + " does not support writing");
		}
		default:
			throw new Exception("Invalid Member Type. This method only supports MemberTypes.Field or MemberTypes.Property");
		}
	}
}
