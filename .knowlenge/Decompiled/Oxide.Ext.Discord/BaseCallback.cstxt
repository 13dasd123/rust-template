using System;
using Oxide.Ext.Discord.Types;

public abstract class BaseCallback<T> : BasePoolable
{
	private readonly Action<T> _callback;

	protected BaseCallback()
	{
		_callback = CallbackInternal;
	}

	protected abstract void HandleCallback(T data);

	public virtual void Start(T data)
	{
		_callback(data);
	}

	private void CallbackInternal(T data)
	{
		try
		{
			HandleCallback(data);
		}
		finally
		{
			Dispose();
		}
	}
}
