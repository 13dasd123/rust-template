using System;
using Oxide.Ext.Discord.Cache;
using Oxide.Ext.Discord.Libraries;
using Oxide.Ext.Discord.Types;

internal class Boxed<T> : IBoxed, IDisposable
{
	public T Value;

	private bool _disposed;

	internal DiscordPluginPool Pool;

	public override string ToString()
	{
		return Singleton<StringCache<T>>.Instance.ToString(Value);
	}

	internal void LeavePool()
	{
		_disposed = false;
	}

	public IBoxed Copy()
	{
		return Pool.GetBoxed(Value);
	}

	public void Dispose()
	{
		if (_disposed)
		{
			throw new ObjectDisposedException("Boxed<" + typeof(T).Name + ">");
		}
		_disposed = true;
		DiscordPool.Internal.FreeBoxed(this);
	}
}
