using System;
using Oxide.Ext.Discord.Entities;
using Oxide.Ext.Discord.Interfaces;
using Oxide.Ext.Discord.Types;

internal abstract class BaseTimerInstance : BasePoolable
{
	internal IPendingPromise PendingPromise;

	public Snowflake Id => PendingPromise.Id;

	public bool IsCompleted { get; private set; }

	public abstract void Update(float currentTime);

	protected void Init()
	{
		PendingPromise = Promise.Create();
	}

	internal void Resolve()
	{
		PendingPromise.Resolve();
		IsCompleted = true;
	}

	public void Reject(Exception ex)
	{
		PendingPromise.Reject(ex);
		IsCompleted = true;
	}

	protected override void EnterPool()
	{
		PendingPromise = null;
	}
}
