using Oxide.Ext.Discord.Callbacks;
using Oxide.Ext.Discord.Entities;
using Oxide.Ext.Discord.Libraries;

internal class AppCommandCallback : BaseNextTickCallback
{
	private BaseAppCommand _command;

	private DiscordInteraction _interaction;

	public static void Start(BaseAppCommand command, DiscordInteraction interaction)
	{
		AppCommandCallback appCommandCallback = DiscordPool.Internal.Get<AppCommandCallback>();
		appCommandCallback.Init(command, interaction);
		appCommandCallback.Run();
	}

	private void Init(BaseAppCommand command, DiscordInteraction interaction)
	{
		_command = command;
		_interaction = interaction;
	}

	protected override void HandleCallback()
	{
		_command.HandleCommandInternal(_interaction);
	}

	protected override void EnterPool()
	{
		_command = null;
		_interaction = null;
	}
}
