using System;
using System.IO;
using System.Net;
using System.Net.Http;
using System.Threading.Tasks;
using Oxide.Ext.Discord.Extensions;

public class DiscordStreamContent : HttpContent
{
	private readonly MemoryStream _content;

	public DiscordStreamContent(MemoryStream content)
	{
		_content = content ?? throw new ArgumentNullException("content");
	}

	protected override Task SerializeToStreamAsync(Stream stream, TransportContext context)
	{
		_content.CopyToPooled(stream);
		return Task.CompletedTask;
	}

	protected override bool TryComputeLength(out long length)
	{
		length = _content.Length;
		return true;
	}

	protected override Task<Stream> CreateContentReadStreamAsync()
	{
		return Task.FromResult((Stream)_content);
	}
}
