using System;
using Facepunch;
using Facepunch.Models;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using UnityEngine;

public class Manifest
{
	public class Administrator
	{
		public string UserId;

		public string Level;
	}

	public class NewsInfo
	{
		public class BlogInfo
		{
			public DateTime Date;

			public string ShortName;

			public string Title;

			public string HeaderImage;

			public string SummaryHtml;

			public string Url;

			public string Tags;
		}

		public BlogInfo[] Blogs;
	}

	public class ServersInfo
	{
		public ServerDesc[] Official;

		public string[] Banned;

		public bool IsBannedServer(string ip)
		{
			string[] banned = Banned;
			foreach (string text in banned)
			{
				if (text.EndsWith("*") && ip.StartsWith(text.Substring(0, text.Length - 1)))
				{
					return true;
				}
				if (ip == text)
				{
					return true;
				}
			}
			return false;
		}
	}

	public class ServerDesc
	{
		public string Address;

		public int Port;
	}

	public NewsInfo News;

	public ServersInfo Servers;

	public FeaturesInfo Features = new FeaturesInfo();

	public string ExceptionReportingUrl;

	public string BenchmarkUrl;

	public string AnalyticUrl;

	public string DatabaseUrl;

	public string LeaderboardUrl;

	public string ReportUrl;

	public string AccountUrl;

	public Hero[] Heroes;

	public Administrator[] Administrators;

	public JObject Metadata;

	internal static Facepunch.Models.Manifest FromJson(string text)
	{
		if (Facepunch.Application.Integration.DebugOutput)
		{
			Debug.Log("[Manifest] " + text);
		}
		Facepunch.Models.Manifest manifest = JsonConvert.DeserializeObject<Facepunch.Models.Manifest>(text);
		if (manifest == null)
		{
			return null;
		}
		if (manifest.Servers == null)
		{
			return null;
		}
		if (manifest.Features == null)
		{
			manifest.Features = new FeaturesInfo();
		}
		return manifest;
	}
}
